{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\lelic\\\\Desktop\\\\FiveStar-Booking\\\\frontend\\\\src\\\\BookHotelContext.js\",\n    _s = $RefreshSig$();\n\nimport { format } from \"date-fns\";\nimport { createContext, useContext, useEffect, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router\";\nimport { useTranslation } from 'react-i18next';\nimport AuthContext from \"./AuthContext\";\nimport SendWelcomeEmailContext from \"./SendWelcomeEmailContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst BookHotelContext = /*#__PURE__*/createContext();\nexport default BookHotelContext;\nexport const BookHotelProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  let [checkin, setCheckin] = useState(new Date());\n  let [checkout, setCheckout] = useState(new Date());\n  const [t, i18n] = useTranslation();\n  let url = window.location.href;\n  const navigate = useNavigate();\n  const {\n    sendBookingEmail\n  } = useContext(SendWelcomeEmailContext);\n  const {\n    sendBookingEmailDe\n  } = useContext(SendWelcomeEmailContext);\n  let {\n    user\n  } = useContext(AuthContext);\n  let params = url.substring(url.length - 1);\n  let cooki = document.cookie;\n  let seperate = cooki.split('=');\n  const csrfToken = seperate[1];\n  const [bookedDates, setBookedDates] = useState([]);\n\n  const bookHotelDate = async e => {\n    e.preventDefault();\n    const api = await fetch('/api/reserv/', {\n      method: 'POST',\n      headers: {\n        \"X-CSRFToken\": csrfToken,\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        \"checkin\": format(checkin, 'yyyy-MM-dd'),\n        \"checkout\": format(checkout, 'yyyy-MM-dd'),\n        \"current_user\": user.user_id,\n        \"current_hotel\": parseInt(params)\n      })\n    });\n\n    if (api.status === 200) {\n      alert('You have successfully booked the date');\n    } else {\n      alert('Room booked already');\n    }\n\n    if (i18n.language === 'de') {\n      sendBookingEmailDe();\n    } else {\n      sendBookingEmail();\n    }\n  };\n\n  const request = async () => {\n    const getApi = await fetch('/api/allres');\n    let data = await getApi.json();\n    setBookedDates(data);\n  };\n\n  useEffect(() => {\n    request();\n  }, []);\n  let filteredDates;\n  let oneDate;\n  let numCardItems;\n  let disabledDays;\n  let singleDisabledDay;\n\n  if (user && parseInt(params)) {\n    filteredDates = bookedDates.filter(each => each.current_user === user.user_id && each.current_hotel === parseInt(params));\n    oneDate = filteredDates[filteredDates.length - 1];\n  }\n\n  if (user) {\n    numCardItems = bookedDates.filter(each => each.current_user === user.user_id);\n  }\n\n  if (user && parseInt(params)) {\n    disabledDays = bookedDates.filter(each => each.current_user !== user.user_id && each.current_hotel === parseInt(params));\n    singleDisabledDay = disabledDays[disabledDays.length - 1];\n  }\n\n  if (!singleDisabledDay) {\n    singleDisabledDay = {\n      checkin: '2050-01-01',\n      checkout: '2060-01-01'\n    };\n  }\n\n  let bookingData = {\n    checkin: checkin,\n    setCheckin: setCheckin,\n    checkout: checkout,\n    setCheckout: setCheckout,\n    bookHotelDate: bookHotelDate,\n    oneDate: oneDate,\n    numCardItems: numCardItems,\n    singleDisabledDay: singleDisabledDay\n  };\n  return /*#__PURE__*/_jsxDEV(BookHotelContext.Provider, {\n    value: bookingData,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 109,\n    columnNumber: 9\n  }, this);\n};\n\n_s(BookHotelProvider, \"38XktRwlUO4d3z6m4pcVxNv4tsU=\", false, function () {\n  return [useTranslation, useNavigate];\n});\n\n_c = BookHotelProvider;\n\nvar _c;\n\n$RefreshReg$(_c, \"BookHotelProvider\");","map":{"version":3,"names":["format","createContext","useContext","useEffect","useState","useParams","useNavigate","useTranslation","AuthContext","SendWelcomeEmailContext","BookHotelContext","BookHotelProvider","children","checkin","setCheckin","Date","checkout","setCheckout","t","i18n","url","window","location","href","navigate","sendBookingEmail","sendBookingEmailDe","user","params","substring","length","cooki","document","cookie","seperate","split","csrfToken","bookedDates","setBookedDates","bookHotelDate","e","preventDefault","api","fetch","method","headers","body","JSON","stringify","user_id","parseInt","status","alert","language","request","getApi","data","json","filteredDates","oneDate","numCardItems","disabledDays","singleDisabledDay","filter","each","current_user","current_hotel","bookingData"],"sources":["C:/Users/lelic/Desktop/FiveStar-Booking/frontend/src/BookHotelContext.js"],"sourcesContent":["import { format } from \"date-fns\";\r\nimport { createContext, useContext, useEffect, useState } from \"react\";\r\nimport { useParams,useNavigate } from \"react-router\";\r\nimport { useTranslation } from 'react-i18next';\r\nimport AuthContext from \"./AuthContext\";\r\nimport SendWelcomeEmailContext from \"./SendWelcomeEmailContext\";\r\nconst BookHotelContext = createContext();\r\nexport default BookHotelContext;\r\nexport const BookHotelProvider = ({children}) => {\r\n    let [checkin, setCheckin] = useState(new Date());\r\n    let [checkout, setCheckout] = useState(new Date());\r\n    const [t,i18n] = useTranslation()\r\n    \r\n    let url = window.location.href\r\n    const navigate = useNavigate()\r\n    const { sendBookingEmail } = useContext(SendWelcomeEmailContext)\r\n    const { sendBookingEmailDe } = useContext(SendWelcomeEmailContext)\r\n    let { user } =  useContext(AuthContext)\r\n    let params = url.substring(url.length - 1)\r\n    let cooki = document.cookie\r\n    let seperate = cooki.split('=')\r\n    const csrfToken = seperate[1]\r\n    const [bookedDates,setBookedDates] = useState([])\r\n    \r\n    const bookHotelDate = async(e) => {\r\n        e.preventDefault()\r\n        \r\n        const api = await fetch('/api/reserv/',{\r\n            method:'POST',\r\n            headers: {\r\n                \"X-CSRFToken\": csrfToken,\r\n                'Content-Type': 'application/json'\r\n            },\r\n            body:JSON.stringify(\r\n                {\r\n                    \"checkin\":format(checkin, 'yyyy-MM-dd'),\r\n                    \"checkout\":format(checkout, 'yyyy-MM-dd'),\r\n                    \"current_user\": user.user_id ,\r\n                    \"current_hotel\": parseInt(params)\r\n                }\r\n                )\r\n        })\r\n        \r\n        \r\n        if (api.status === 200){\r\n            alert('You have successfully booked the date')\r\n           \r\n            \r\n        }\r\n        else {\r\n            alert('Room booked already')\r\n        }\r\n        if (i18n.language === 'de'){\r\n            sendBookingEmailDe()\r\n        }else{\r\n\r\n            sendBookingEmail()\r\n        }\r\n    }\r\n    const request = async() => {\r\n        const getApi = await fetch('/api/allres')\r\n        let data =  await getApi.json()\r\n        setBookedDates(data)\r\n    }\r\n    useEffect(() => {\r\n        request()\r\n    },[])\r\n    let filteredDates;\r\n    let oneDate;\r\n    let numCardItems;\r\n    let disabledDays;\r\n    let singleDisabledDay;\r\n    if(user && parseInt(params) ){\r\n        filteredDates = bookedDates.filter(each => each.current_user ===   user.user_id   && each.current_hotel === parseInt(params))\r\n        oneDate = filteredDates[filteredDates.length - 1]\r\n    }\r\n    if(user){\r\n        numCardItems = bookedDates.filter(each => each.current_user ===   user.user_id)\r\n    }\r\n    if(user && parseInt(params))\r\n    {\r\n        disabledDays = bookedDates.filter(each => each.current_user !==  user.user_id && each.current_hotel === parseInt(params) )\r\n     \r\n        singleDisabledDay = disabledDays[disabledDays.length - 1]\r\n    \r\n        \r\n       \r\n    }\r\n    if (!singleDisabledDay){\r\n        singleDisabledDay = {\r\n            checkin:'2050-01-01',\r\n            checkout: '2060-01-01'\r\n        }\r\n    }\r\n   \r\n    let bookingData = {\r\n        checkin:checkin,\r\n        setCheckin:setCheckin,\r\n        checkout:checkout,\r\n        setCheckout:setCheckout,\r\n        bookHotelDate:bookHotelDate,\r\n        oneDate:oneDate,\r\n        numCardItems:numCardItems,\r\n        singleDisabledDay:singleDisabledDay\r\n    }\r\n \r\n  \r\n    return (\r\n        <BookHotelContext.Provider value={bookingData}>\r\n              { children }\r\n        </BookHotelContext.Provider>\r\n        \r\n        )\r\n}\r\n"],"mappings":";;;AAAA,SAASA,MAAT,QAAuB,UAAvB;AACA,SAASC,aAAT,EAAwBC,UAAxB,EAAoCC,SAApC,EAA+CC,QAA/C,QAA+D,OAA/D;AACA,SAASC,SAAT,EAAmBC,WAAnB,QAAsC,cAAtC;AACA,SAASC,cAAT,QAA+B,eAA/B;AACA,OAAOC,WAAP,MAAwB,eAAxB;AACA,OAAOC,uBAAP,MAAoC,2BAApC;;AACA,MAAMC,gBAAgB,gBAAGT,aAAa,EAAtC;AACA,eAAeS,gBAAf;AACA,OAAO,MAAMC,iBAAiB,GAAG,QAAgB;EAAA;;EAAA,IAAf;IAACC;EAAD,CAAe;EAC7C,IAAI,CAACC,OAAD,EAAUC,UAAV,IAAwBV,QAAQ,CAAC,IAAIW,IAAJ,EAAD,CAApC;EACA,IAAI,CAACC,QAAD,EAAWC,WAAX,IAA0Bb,QAAQ,CAAC,IAAIW,IAAJ,EAAD,CAAtC;EACA,MAAM,CAACG,CAAD,EAAGC,IAAH,IAAWZ,cAAc,EAA/B;EAEA,IAAIa,GAAG,GAAGC,MAAM,CAACC,QAAP,CAAgBC,IAA1B;EACA,MAAMC,QAAQ,GAAGlB,WAAW,EAA5B;EACA,MAAM;IAAEmB;EAAF,IAAuBvB,UAAU,CAACO,uBAAD,CAAvC;EACA,MAAM;IAAEiB;EAAF,IAAyBxB,UAAU,CAACO,uBAAD,CAAzC;EACA,IAAI;IAAEkB;EAAF,IAAYzB,UAAU,CAACM,WAAD,CAA1B;EACA,IAAIoB,MAAM,GAAGR,GAAG,CAACS,SAAJ,CAAcT,GAAG,CAACU,MAAJ,GAAa,CAA3B,CAAb;EACA,IAAIC,KAAK,GAAGC,QAAQ,CAACC,MAArB;EACA,IAAIC,QAAQ,GAAGH,KAAK,CAACI,KAAN,CAAY,GAAZ,CAAf;EACA,MAAMC,SAAS,GAAGF,QAAQ,CAAC,CAAD,CAA1B;EACA,MAAM,CAACG,WAAD,EAAaC,cAAb,IAA+BlC,QAAQ,CAAC,EAAD,CAA7C;;EAEA,MAAMmC,aAAa,GAAG,MAAMC,CAAN,IAAY;IAC9BA,CAAC,CAACC,cAAF;IAEA,MAAMC,GAAG,GAAG,MAAMC,KAAK,CAAC,cAAD,EAAgB;MACnCC,MAAM,EAAC,MAD4B;MAEnCC,OAAO,EAAE;QACL,eAAeT,SADV;QAEL,gBAAgB;MAFX,CAF0B;MAMnCU,IAAI,EAACC,IAAI,CAACC,SAAL,CACD;QACI,WAAUhD,MAAM,CAACa,OAAD,EAAU,YAAV,CADpB;QAEI,YAAWb,MAAM,CAACgB,QAAD,EAAW,YAAX,CAFrB;QAGI,gBAAgBW,IAAI,CAACsB,OAHzB;QAII,iBAAiBC,QAAQ,CAACtB,MAAD;MAJ7B,CADC;IAN8B,CAAhB,CAAvB;;IAiBA,IAAIc,GAAG,CAACS,MAAJ,KAAe,GAAnB,EAAuB;MACnBC,KAAK,CAAC,uCAAD,CAAL;IAGH,CAJD,MAKK;MACDA,KAAK,CAAC,qBAAD,CAAL;IACH;;IACD,IAAIjC,IAAI,CAACkC,QAAL,KAAkB,IAAtB,EAA2B;MACvB3B,kBAAkB;IACrB,CAFD,MAEK;MAEDD,gBAAgB;IACnB;EACJ,CAlCD;;EAmCA,MAAM6B,OAAO,GAAG,YAAW;IACvB,MAAMC,MAAM,GAAG,MAAMZ,KAAK,CAAC,aAAD,CAA1B;IACA,IAAIa,IAAI,GAAI,MAAMD,MAAM,CAACE,IAAP,EAAlB;IACAnB,cAAc,CAACkB,IAAD,CAAd;EACH,CAJD;;EAKArD,SAAS,CAAC,MAAM;IACZmD,OAAO;EACV,CAFQ,EAEP,EAFO,CAAT;EAGA,IAAII,aAAJ;EACA,IAAIC,OAAJ;EACA,IAAIC,YAAJ;EACA,IAAIC,YAAJ;EACA,IAAIC,iBAAJ;;EACA,IAAGnC,IAAI,IAAIuB,QAAQ,CAACtB,MAAD,CAAnB,EAA6B;IACzB8B,aAAa,GAAGrB,WAAW,CAAC0B,MAAZ,CAAmBC,IAAI,IAAIA,IAAI,CAACC,YAAL,KAAwBtC,IAAI,CAACsB,OAA7B,IAA0Ce,IAAI,CAACE,aAAL,KAAuBhB,QAAQ,CAACtB,MAAD,CAApG,CAAhB;IACA+B,OAAO,GAAGD,aAAa,CAACA,aAAa,CAAC5B,MAAd,GAAuB,CAAxB,CAAvB;EACH;;EACD,IAAGH,IAAH,EAAQ;IACJiC,YAAY,GAAGvB,WAAW,CAAC0B,MAAZ,CAAmBC,IAAI,IAAIA,IAAI,CAACC,YAAL,KAAwBtC,IAAI,CAACsB,OAAxD,CAAf;EACH;;EACD,IAAGtB,IAAI,IAAIuB,QAAQ,CAACtB,MAAD,CAAnB,EACA;IACIiC,YAAY,GAAGxB,WAAW,CAAC0B,MAAZ,CAAmBC,IAAI,IAAIA,IAAI,CAACC,YAAL,KAAuBtC,IAAI,CAACsB,OAA5B,IAAuCe,IAAI,CAACE,aAAL,KAAuBhB,QAAQ,CAACtB,MAAD,CAAjG,CAAf;IAEAkC,iBAAiB,GAAGD,YAAY,CAACA,YAAY,CAAC/B,MAAb,GAAsB,CAAvB,CAAhC;EAIH;;EACD,IAAI,CAACgC,iBAAL,EAAuB;IACnBA,iBAAiB,GAAG;MAChBjD,OAAO,EAAC,YADQ;MAEhBG,QAAQ,EAAE;IAFM,CAApB;EAIH;;EAED,IAAImD,WAAW,GAAG;IACdtD,OAAO,EAACA,OADM;IAEdC,UAAU,EAACA,UAFG;IAGdE,QAAQ,EAACA,QAHK;IAIdC,WAAW,EAACA,WAJE;IAKdsB,aAAa,EAACA,aALA;IAMdoB,OAAO,EAACA,OANM;IAOdC,YAAY,EAACA,YAPC;IAQdE,iBAAiB,EAACA;EARJ,CAAlB;EAYA,oBACI,QAAC,gBAAD,CAAkB,QAAlB;IAA2B,KAAK,EAAEK,WAAlC;IAAA,UACQvD;EADR;IAAA;IAAA;IAAA;EAAA,QADJ;AAMH,CAzGM;;GAAMD,iB;UAGQJ,c,EAGAD,W;;;KANRK,iB"},"metadata":{},"sourceType":"module"}